{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "QeMLflow Configuration Schema",
  "description": "Enterprise-grade configuration validation schema for QeMLflow",
  "type": "object",
  "properties": {
    "application": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1,
          "maxLength": 100
        },
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9]+)?$"
        },
        "environment": {
          "type": "string",
          "enum": ["development", "testing", "staging", "production", "local"]
        },
        "debug": {
          "type": "boolean"
        },
        "log_level": {
          "type": "string",
          "enum": ["DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL"]
        },
        "metadata": {
          "type": "object",
          "properties": {
            "created_at": {"type": "string"},
            "config_version": {"type": "string"},
            "build_hash": {"type": "string"}
          }
        }
      },
      "required": ["name", "version", "environment"],
      "additionalProperties": false
    },
    "security": {
      "type": "object",
      "properties": {
        "authentication": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean"},
            "method": {
              "type": "string",
              "enum": ["oauth2", "jwt", "basic", "api_key"]
            },
            "token_expiry": {
              "type": "integer",
              "minimum": 60,
              "maximum": 86400
            }
          },
          "required": ["enabled"],
          "additionalProperties": false
        },
        "authorization": {
          "type": "object",
          "properties": {
            "rbac_enabled": {"type": "boolean"},
            "default_role": {
              "type": "string",
              "enum": ["admin", "user", "readonly", "guest"]
            },
            "admin_users": {
              "type": "array",
              "items": {"type": "string"}
            }
          },
          "additionalProperties": false
        },
        "encryption": {
          "type": "object",
          "properties": {
            "data_at_rest": {"type": "boolean"},
            "data_in_transit": {"type": "boolean"},
            "algorithm": {
              "type": "string",
              "enum": ["AES-256-GCM", "AES-256-CBC", "ChaCha20-Poly1305"]
            }
          },
          "additionalProperties": false
        },
        "session": {
          "type": "object",
          "properties": {
            "secure_cookies": {"type": "boolean"},
            "same_site": {
              "type": "string",
              "enum": ["strict", "lax", "none"]
            },
            "max_age": {
              "type": "integer",
              "minimum": 300,
              "maximum": 86400
            }
          },
          "additionalProperties": false
        }
      },
      "required": ["authentication"],
      "additionalProperties": false
    },
    "database": {
      "type": "object",
      "properties": {
        "url": {
          "type": "string",
          "minLength": 1
        },
        "echo": {"type": "boolean"},
        "pool_size": {
          "type": "integer",
          "minimum": 1,
          "maximum": 100
        },
        "max_overflow": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100
        },
        "pool_timeout": {
          "type": "integer",
          "minimum": 1,
          "maximum": 300
        },
        "connect_args": {
          "type": "object"
        }
      },
      "required": ["url"],
      "additionalProperties": false
    },
    "performance": {
      "type": "object",
      "properties": {
        "workers": {
          "type": "integer",
          "minimum": 1,
          "maximum": 32
        },
        "max_connections": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10000
        },
        "timeout": {
          "type": "integer",
          "minimum": 1,
          "maximum": 300
        },
        "keep_alive": {
          "type": "integer",
          "minimum": 1,
          "maximum": 60
        },
        "cache": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean"},
            "backend": {
              "type": "string",
              "enum": ["memory", "redis", "memcached"]
            },
            "ttl": {
              "type": "integer",
              "minimum": 60,
              "maximum": 86400
            },
            "max_size": {
              "type": "string",
              "pattern": "^\\d+[KMG]B$"
            }
          },
          "additionalProperties": false
        },
        "optimizations": {
          "type": "object",
          "properties": {
            "lazy_loading": {"type": "boolean"},
            "connection_pooling": {"type": "boolean"},
            "query_caching": {"type": "boolean"},
            "static_file_caching": {"type": "boolean"}
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "monitoring": {
      "type": "object",
      "properties": {
        "metrics": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean"},
            "port": {
              "type": "integer",
              "minimum": 1024,
              "maximum": 65535
            },
            "path": {
              "type": "string",
              "pattern": "^/[a-zA-Z0-9/_-]*$"
            }
          },
          "additionalProperties": false
        },
        "health_checks": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean"},
            "interval": {
              "type": "integer",
              "minimum": 10,
              "maximum": 300
            },
            "timeout": {
              "type": "integer",
              "minimum": 1,
              "maximum": 60
            }
          },
          "additionalProperties": false
        },
        "logging": {
          "type": "object",
          "properties": {
            "format": {
              "type": "string",
              "enum": ["json", "text", "structured"]
            },
            "level": {
              "type": "string",
              "enum": ["DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL"]
            },
            "rotation": {
              "type": "string",
              "enum": ["daily", "weekly", "monthly", "size"]
            },
            "max_size": {
              "type": "string",
              "pattern": "^\\d+[KMG]B$"
            },
            "retention_days": {
              "type": "integer",
              "minimum": 1,
              "maximum": 365
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "resources": {
      "type": "object",
      "properties": {
        "memory": {
          "type": "object",
          "properties": {
            "limit": {
              "type": "string",
              "pattern": "^\\d+[KMG]B$"
            },
            "warning_threshold": {
              "type": "number",
              "minimum": 0.1,
              "maximum": 1.0
            }
          },
          "additionalProperties": false
        },
        "cpu": {
          "type": "object",
          "properties": {
            "limit": {
              "type": "string",
              "pattern": "^\\d+(\\.\\d+)?$"
            },
            "warning_threshold": {
              "type": "number",
              "minimum": 0.1,
              "maximum": 1.0
            }
          },
          "additionalProperties": false
        },
        "disk": {
          "type": "object",
          "properties": {
            "limit": {
              "type": "string",
              "pattern": "^\\d+[KMG]B$"
            },
            "warning_threshold": {
              "type": "number",
              "minimum": 0.1,
              "maximum": 1.0
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "scientific": {
      "type": "object",
      "properties": {
        "experiment_tracking": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean"},
            "backend": {
              "type": "string",
              "enum": ["mlflow", "wandb", "tensorboard", "neptune"]
            },
            "auto_log": {"type": "boolean"}
          },
          "additionalProperties": false
        },
        "model_optimization": {
          "type": "object",
          "properties": {
            "parallel_training": {"type": "boolean"},
            "gpu_acceleration": {"type": "boolean"},
            "memory_optimization": {"type": "boolean"}
          },
          "additionalProperties": false
        },
        "quantum": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean"},
            "backend": {
              "type": "string",
              "enum": ["qiskit", "cirq", "pennylane", "braket"]
            },
            "simulator": {"type": "boolean"}
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "external_services": {
      "type": "object",
      "properties": {
        "redis": {
          "type": "object",
          "properties": {
            "url": {"type": "string"},
            "pool_size": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100
            },
            "timeout": {
              "type": "integer",
              "minimum": 1,
              "maximum": 60
            }
          },
          "additionalProperties": false
        },
        "message_queue": {
          "type": "object",
          "properties": {
            "backend": {
              "type": "string",
              "enum": ["celery", "rq", "dramatiq"]
            },
            "broker_url": {"type": "string"},
            "result_backend": {"type": "string"}
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "features": {
      "type": "object",
      "properties": {
        "new_ui": {"type": "boolean"},
        "advanced_analytics": {"type": "boolean"},
        "experimental_algorithms": {"type": "boolean"},
        "api_v2": {"type": "boolean"}
      },
      "additionalProperties": true
    },
    "custom": {
      "type": "object",
      "additionalProperties": true
    }
  },
  "required": ["application"],
  "additionalProperties": false
}
